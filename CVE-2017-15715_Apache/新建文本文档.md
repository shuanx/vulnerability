# CVE-2017-15715

## 漏洞简介

Apache HTTPD是一款HTTP服务器，它可以通过mod_php来运行PHP网页。其2.4.0~2.4.29版本中存在一个解析漏洞，在解析PHP时，`1.php\x0A`将被按照PHP后缀进行解析，导致绕过一些服务器的安全策略。

## 漏洞环境

```
# 这里使用vulhub提供的环境
docker pull cve-2017-15715_apache
docker run -d -p 8080:80 -it cve-2017-15715_apache
```

启动后直接访问，`http://your-ip:8080`

## 漏洞复现

1. 本地新建一个文件`phpinfo.php`，内容为

```
<?=phpinfo();
```

2. 在网页上传文件，然后使用`Brupsuite`抓包

![image-20200608091436981](CVE-2017-15715.assets/image-20200608091436981.png)

3. 转到Request的Hex编码这里，在70 68 70后面插入`0a`，如图所示：

![image-20200608091416429](CVE-2017-15715.assets/image-20200608091416429.png)

4. 点击上传，可以看到后台已经生成对应的文件

![image-20200608091706593](CVE-2017-15715.assets/image-20200608091706593.png)

5. 使用`Burpsuite`访问

![image-20200608091802049](CVE-2017-15715.assets/image-20200608091802049.png)

## 参考资料